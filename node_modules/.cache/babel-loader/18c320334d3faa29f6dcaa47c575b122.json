{"ast":null,"code":"var _this = this,\n  _jsxFileName = \"/home/CPA/CPA/src/components/canvas/index.tsx\";\nimport React from 'react';\nimport { useRef, useEffect } from 'react';\nimport { step, stepAuto, mouseMove, endOfGame } from './state';\nimport { render } from './renderer';\nimport * as jeu from './game';\nvar initCanvas = function initCanvas(iterate) {\n  return function (canvas) {\n    var ctx = canvas.getContext('2d');\n    if (!ctx) return;\n    requestAnimationFrame(function () {\n      return iterate(ctx);\n    });\n  };\n};\n\n//Initialisation des plateformes (global car on les connait toutes à l'avance)\nexport var ensPlat = [new jeu.Plateforme({\n  x: 0,\n  y: 0,\n  longueur: 100,\n  largeur: 810\n}), new jeu.Plateforme({\n  x: 700,\n  y: 580,\n  longueur: 200,\n  largeur: 70\n}), new jeu.Plateforme({\n  x: 2000,\n  y: 470,\n  longueur: 200,\n  largeur: 70\n}), new jeu.Plateforme({\n  x: 1200,\n  y: 615,\n  longueur: 70,\n  largeur: 70\n}), new jeu.Plateforme({\n  x: 1800,\n  y: 615,\n  longueur: 70,\n  largeur: 70\n}), new jeu.Plateforme({\n  x: 2400,\n  y: 390,\n  longueur: 100,\n  largeur: 300\n}), new jeu.Plateforme({\n  x: 2250,\n  y: 340,\n  longueur: 100,\n  largeur: 70\n}), new jeu.Plateforme({\n  x: 2700,\n  y: 340,\n  longueur: 200,\n  largeur: 70\n}), new jeu.Plateforme({\n  x: 3050,\n  y: 340,\n  longueur: 200,\n  largeur: 70\n}), new jeu.Plateforme({\n  x: 3400,\n  y: 390,\n  longueur: 100,\n  largeur: 300\n}), new jeu.Plateforme({\n  x: 2500,\n  y: 525,\n  longueur: 100,\n  largeur: 70\n}), new jeu.Plateforme({\n  x: 3500,\n  y: 480,\n  longueur: 100,\n  largeur: 70\n}), new jeu.Plateforme({\n  x: 3650,\n  y: 550,\n  longueur: 100,\n  largeur: 70\n}), new jeu.Plateforme({\n  x: 6000,\n  y: 0,\n  longueur: 100,\n  largeur: 810\n}), new jeu.Plateforme({\n  x: 3650,\n  y: 550,\n  longueur: 100,\n  largeur: 70\n})];\n\n//Initialisation des ennemis (global car on les connait tous à l'avance)\nexport var ensEnnemis = [new jeu.Ennemi({\n  x: 2800,\n  y: 610,\n  HP: 3,\n  speed: 4,\n  velX: 0,\n  velY: 0,\n  dist_parcouru: 0,\n  dist_max: 200\n}), new jeu.Ennemi({\n  x: 1400,\n  y: 610,\n  HP: 3,\n  speed: 6,\n  velX: 0,\n  velY: 0,\n  dist_parcouru: 0,\n  dist_max: 300\n}), new jeu.Ennemi({\n  x: 2900,\n  y: 610,\n  HP: 3,\n  speed: 6,\n  velX: 0,\n  velY: 0,\n  dist_parcouru: 0,\n  dist_max: 200\n}), new jeu.Ennemi({\n  x: 4600,\n  y: 610,\n  HP: 3,\n  speed: 6,\n  velX: 0,\n  velY: 0,\n  dist_parcouru: 0,\n  dist_max: 300\n}), new jeu.Ennemi({\n  x: 2500,\n  y: 240,\n  HP: 2,\n  speed: 3,\n  velX: 0,\n  velY: 0,\n  dist_parcouru: 0,\n  dist_max: 300,\n  type: 'volant'\n}), new jeu.Ennemi({\n  x: 4100,\n  y: 450,\n  HP: 2,\n  speed: 5,\n  velX: 0,\n  velY: 0,\n  dist_parcouru: 0,\n  dist_max: 300,\n  type: 'volant'\n}), new jeu.Ennemi({\n  x: 5500,\n  y: 550,\n  HP: 2,\n  speed: 5,\n  velX: 0,\n  velY: 0,\n  dist_parcouru: 0,\n  dist_max: 300,\n  type: 'volant'\n})];\n\n//le tableau s'occupant de tracker les balles instantiees\nexport var ensBalle = [];\nvar i = -1;\nvar j = -1;\nvar Canvas = function Canvas(_ref) {\n  var height = _ref.height,\n    width = _ref.width;\n  //initialisation\n  var initialState = {\n    joueur: {\n      pos: {\n        x: 200,\n        y: 600\n      },\n      HP: 5,\n      speed: 10,\n      velX: 0,\n      velY: 0\n    },\n    endOfGame: true,\n    platforms: ensPlat,\n    camera: {\n      x: 700,\n      y: 0,\n      widthC: width,\n      heightC: height\n    },\n    ennemis: ensEnnemis,\n    balle: ensBalle\n  };\n  var ref = useRef();\n  var state = useRef(initialState);\n  var iterate = function iterate(ctx) {\n    state.current = step(state.current);\n    state.current = stepAuto(state.current);\n    state.current.endOfGame = !endOfGame(state.current);\n    render(ctx, ensPlat)(state.current);\n    if (!state.current.endOfGame) requestAnimationFrame(function () {\n      return iterate(ctx);\n    });\n  };\n  var onMove = function onMove(e) {\n    state.current = mouseMove(state.current)(e);\n  };\n  useEffect(function () {\n    initCanvas(iterate)(ref.current);\n  }, []);\n  return /*#__PURE__*/React.createElement(\"canvas\", {\n    height: height,\n    width: width,\n    ref: ref,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 10\n    }\n  });\n};\nexport default Canvas;","map":{"version":3,"names":["React","useRef","useEffect","step","stepAuto","mouseMove","endOfGame","render","jeu","initCanvas","iterate","canvas","ctx","getContext","requestAnimationFrame","ensPlat","Plateforme","x","y","longueur","largeur","ensEnnemis","Ennemi","HP","speed","velX","velY","dist_parcouru","dist_max","type","ensBalle","i","j","Canvas","_ref","height","width","initialState","joueur","pos","platforms","camera","widthC","heightC","ennemis","balle","ref","state","current","onMove","e","createElement","__self","_this","__source","fileName","_jsxFileName","lineNumber","columnNumber"],"sources":["/home/CPA/CPA/src/components/canvas/index.tsx"],"sourcesContent":["import React from 'react'\nimport { useRef, useEffect } from 'react'\nimport { State, step, stepAuto,mouseMove,endOfGame} from './state'\nimport { render} from './renderer'\n\nimport * as jeu from './game'\n\nconst initCanvas =\n  (iterate: (ctx: CanvasRenderingContext2D) => void) =>\n  (canvas: HTMLCanvasElement) => {\n    const ctx = canvas.getContext('2d')\n    if (!ctx) return\n    requestAnimationFrame(() => iterate(ctx))\n  }\n\n\n//Initialisation des plateformes (global car on les connait toutes à l'avance)\nexport let ensPlat = \n  [new jeu.Plateforme({x : 0, y:0, longueur:100, largeur:810}),new jeu.Plateforme({x : 700, y:580, longueur:200, largeur:70}),\n  new jeu.Plateforme({x : 2000, y:470, longueur:200, largeur:70}), new jeu.Plateforme({x : 1200, y:615, longueur:70, largeur:70}),\n  new jeu.Plateforme({x : 1800, y:615, longueur:70, largeur:70}),new jeu.Plateforme({x:2400, y:390, longueur:100, largeur:300}),\n  new jeu.Plateforme({x:2250, y:340, longueur:100, largeur:70}),new jeu.Plateforme({x:2700, y:340, longueur:200, largeur:70}),new jeu.Plateforme({x:3050, y:340, longueur:200, largeur:70}),\n  new jeu.Plateforme({x:3400, y:390, longueur:100, largeur:300}),new jeu.Plateforme({x:2500, y:525, longueur:100, largeur:70}),\n  new jeu.Plateforme({x:3500, y:480, longueur:100, largeur:70}),new jeu.Plateforme({x:3650, y:550, longueur:100, largeur:70}),\n  new jeu.Plateforme({x:6000, y:0, longueur:100, largeur:810}),new jeu.Plateforme({x:3650, y:550, longueur:100, largeur:70})]\n\n//Initialisation des ennemis (global car on les connait tous à l'avance)\nexport let ensEnnemis = \n  [new jeu.Ennemi({x: 2800,y: 610, HP:3, speed:4,velX:0,velY:0,dist_parcouru:0,dist_max:200}),new jeu.Ennemi({x: 1400,y: 610, HP:3, speed:6,velX:0,velY:0,dist_parcouru:0,dist_max:300}),\n    new jeu.Ennemi({x: 2900,y: 610, HP:3, speed:6,velX:0,velY:0,dist_parcouru:0,dist_max:200}),new jeu.Ennemi({x: 4600,y: 610, HP:3, speed:6,velX:0,velY:0,dist_parcouru:0,dist_max:300}),\n    new jeu.Ennemi({x: 2500,y: 240, HP:2, speed:3,velX:0,velY:0,dist_parcouru:0,dist_max:300,type:'volant'}),new jeu.Ennemi({x: 4100,y: 450, HP:2, speed:5,velX:0,velY:0,dist_parcouru:0,dist_max:300,type:'volant'}),\n    new jeu.Ennemi({x: 5500,y: 550, HP:2, speed:5,velX:0,velY:0,dist_parcouru:0,dist_max:300,type:'volant'})]\n\n//le tableau s'occupant de tracker les balles instantiees\nexport let ensBalle = []\n\nlet i = -1\nlet j = -1\nconst Canvas = ({ height, width }: { height: number; width: number }) => {\n  //initialisation\n  const initialState: State = {\n    joueur: {\n      pos: {\n        x: 200,\n        y: 600,\n      },\n      HP: 5,\n      speed: 10,\n      velX: 0,\n      velY: 0,\n    },\n\n\n    endOfGame: true,\n    platforms: ensPlat,\n    camera: {\n      x: 700,\n      y: 0,\n\n      widthC: width,\n      heightC: height,\n    },\n    ennemis: ensEnnemis,\n    balle: ensBalle,\n  }\n\n  const ref = useRef<any>()\n  const state = useRef<State>(initialState)\n\n  const iterate = (ctx: CanvasRenderingContext2D) => {\n\n    state.current = step(state.current)\n    state.current=stepAuto(state.current)\n    state.current.endOfGame = !endOfGame(state.current)\n    render(ctx,ensPlat)(state.current)\n    if (!state.current.endOfGame) requestAnimationFrame(() => iterate(ctx))\n  }\n\n\n  const onMove = (e: PointerEvent) => {\n    state.current = mouseMove(state.current)(e)\n  }\n\n  useEffect(() => {  \n    initCanvas(iterate)(ref.current)\n  }, [])\n  return <canvas {...{ height, width, ref }} />\n}\n\nexport default Canvas\n"],"mappings":";;AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,MAAM,EAAEC,SAAS,QAAQ,OAAO;AACzC,SAAgBC,IAAI,EAAEC,QAAQ,EAACC,SAAS,EAACC,SAAS,QAAO,SAAS;AAClE,SAASC,MAAM,QAAO,YAAY;AAElC,OAAO,KAAKC,GAAG,MAAM,QAAQ;AAE7B,IAAMC,UAAU,GACd,SADIA,UAAUA,CACbC,OAAgD;EAAA,OACjD,UAACC,MAAyB,EAAK;IAC7B,IAAMC,GAAG,GAAGD,MAAM,CAACE,UAAU,CAAC,IAAI,CAAC;IACnC,IAAI,CAACD,GAAG,EAAE;IACVE,qBAAqB,CAAC;MAAA,OAAMJ,OAAO,CAACE,GAAG,CAAC;IAAA,EAAC;EAC3C,CAAC;AAAA;;AAGH;AACA,OAAO,IAAIG,OAAO,GAChB,CAAC,IAAIP,GAAG,CAACQ,UAAU,CAAC;EAACC,CAAC,EAAG,CAAC;EAAEC,CAAC,EAAC,CAAC;EAAEC,QAAQ,EAAC,GAAG;EAAEC,OAAO,EAAC;AAAG,CAAC,CAAC,EAAC,IAAIZ,GAAG,CAACQ,UAAU,CAAC;EAACC,CAAC,EAAG,GAAG;EAAEC,CAAC,EAAC,GAAG;EAAEC,QAAQ,EAAC,GAAG;EAAEC,OAAO,EAAC;AAAE,CAAC,CAAC,EAC3H,IAAIZ,GAAG,CAACQ,UAAU,CAAC;EAACC,CAAC,EAAG,IAAI;EAAEC,CAAC,EAAC,GAAG;EAAEC,QAAQ,EAAC,GAAG;EAAEC,OAAO,EAAC;AAAE,CAAC,CAAC,EAAE,IAAIZ,GAAG,CAACQ,UAAU,CAAC;EAACC,CAAC,EAAG,IAAI;EAAEC,CAAC,EAAC,GAAG;EAAEC,QAAQ,EAAC,EAAE;EAAEC,OAAO,EAAC;AAAE,CAAC,CAAC,EAC/H,IAAIZ,GAAG,CAACQ,UAAU,CAAC;EAACC,CAAC,EAAG,IAAI;EAAEC,CAAC,EAAC,GAAG;EAAEC,QAAQ,EAAC,EAAE;EAAEC,OAAO,EAAC;AAAE,CAAC,CAAC,EAAC,IAAIZ,GAAG,CAACQ,UAAU,CAAC;EAACC,CAAC,EAAC,IAAI;EAAEC,CAAC,EAAC,GAAG;EAAEC,QAAQ,EAAC,GAAG;EAAEC,OAAO,EAAC;AAAG,CAAC,CAAC,EAC7H,IAAIZ,GAAG,CAACQ,UAAU,CAAC;EAACC,CAAC,EAAC,IAAI;EAAEC,CAAC,EAAC,GAAG;EAAEC,QAAQ,EAAC,GAAG;EAAEC,OAAO,EAAC;AAAE,CAAC,CAAC,EAAC,IAAIZ,GAAG,CAACQ,UAAU,CAAC;EAACC,CAAC,EAAC,IAAI;EAAEC,CAAC,EAAC,GAAG;EAAEC,QAAQ,EAAC,GAAG;EAAEC,OAAO,EAAC;AAAE,CAAC,CAAC,EAAC,IAAIZ,GAAG,CAACQ,UAAU,CAAC;EAACC,CAAC,EAAC,IAAI;EAAEC,CAAC,EAAC,GAAG;EAAEC,QAAQ,EAAC,GAAG;EAAEC,OAAO,EAAC;AAAE,CAAC,CAAC,EACzL,IAAIZ,GAAG,CAACQ,UAAU,CAAC;EAACC,CAAC,EAAC,IAAI;EAAEC,CAAC,EAAC,GAAG;EAAEC,QAAQ,EAAC,GAAG;EAAEC,OAAO,EAAC;AAAG,CAAC,CAAC,EAAC,IAAIZ,GAAG,CAACQ,UAAU,CAAC;EAACC,CAAC,EAAC,IAAI;EAAEC,CAAC,EAAC,GAAG;EAAEC,QAAQ,EAAC,GAAG;EAAEC,OAAO,EAAC;AAAE,CAAC,CAAC,EAC5H,IAAIZ,GAAG,CAACQ,UAAU,CAAC;EAACC,CAAC,EAAC,IAAI;EAAEC,CAAC,EAAC,GAAG;EAAEC,QAAQ,EAAC,GAAG;EAAEC,OAAO,EAAC;AAAE,CAAC,CAAC,EAAC,IAAIZ,GAAG,CAACQ,UAAU,CAAC;EAACC,CAAC,EAAC,IAAI;EAAEC,CAAC,EAAC,GAAG;EAAEC,QAAQ,EAAC,GAAG;EAAEC,OAAO,EAAC;AAAE,CAAC,CAAC,EAC3H,IAAIZ,GAAG,CAACQ,UAAU,CAAC;EAACC,CAAC,EAAC,IAAI;EAAEC,CAAC,EAAC,CAAC;EAAEC,QAAQ,EAAC,GAAG;EAAEC,OAAO,EAAC;AAAG,CAAC,CAAC,EAAC,IAAIZ,GAAG,CAACQ,UAAU,CAAC;EAACC,CAAC,EAAC,IAAI;EAAEC,CAAC,EAAC,GAAG;EAAEC,QAAQ,EAAC,GAAG;EAAEC,OAAO,EAAC;AAAE,CAAC,CAAC,CAAC;;AAE7H;AACA,OAAO,IAAIC,UAAU,GACnB,CAAC,IAAIb,GAAG,CAACc,MAAM,CAAC;EAACL,CAAC,EAAE,IAAI;EAACC,CAAC,EAAE,GAAG;EAAEK,EAAE,EAAC,CAAC;EAAEC,KAAK,EAAC,CAAC;EAACC,IAAI,EAAC,CAAC;EAACC,IAAI,EAAC,CAAC;EAACC,aAAa,EAAC,CAAC;EAACC,QAAQ,EAAC;AAAG,CAAC,CAAC,EAAC,IAAIpB,GAAG,CAACc,MAAM,CAAC;EAACL,CAAC,EAAE,IAAI;EAACC,CAAC,EAAE,GAAG;EAAEK,EAAE,EAAC,CAAC;EAAEC,KAAK,EAAC,CAAC;EAACC,IAAI,EAAC,CAAC;EAACC,IAAI,EAAC,CAAC;EAACC,aAAa,EAAC,CAAC;EAACC,QAAQ,EAAC;AAAG,CAAC,CAAC,EACpL,IAAIpB,GAAG,CAACc,MAAM,CAAC;EAACL,CAAC,EAAE,IAAI;EAACC,CAAC,EAAE,GAAG;EAAEK,EAAE,EAAC,CAAC;EAAEC,KAAK,EAAC,CAAC;EAACC,IAAI,EAAC,CAAC;EAACC,IAAI,EAAC,CAAC;EAACC,aAAa,EAAC,CAAC;EAACC,QAAQ,EAAC;AAAG,CAAC,CAAC,EAAC,IAAIpB,GAAG,CAACc,MAAM,CAAC;EAACL,CAAC,EAAE,IAAI;EAACC,CAAC,EAAE,GAAG;EAAEK,EAAE,EAAC,CAAC;EAAEC,KAAK,EAAC,CAAC;EAACC,IAAI,EAAC,CAAC;EAACC,IAAI,EAAC,CAAC;EAACC,aAAa,EAAC,CAAC;EAACC,QAAQ,EAAC;AAAG,CAAC,CAAC,EACrL,IAAIpB,GAAG,CAACc,MAAM,CAAC;EAACL,CAAC,EAAE,IAAI;EAACC,CAAC,EAAE,GAAG;EAAEK,EAAE,EAAC,CAAC;EAAEC,KAAK,EAAC,CAAC;EAACC,IAAI,EAAC,CAAC;EAACC,IAAI,EAAC,CAAC;EAACC,aAAa,EAAC,CAAC;EAACC,QAAQ,EAAC,GAAG;EAACC,IAAI,EAAC;AAAQ,CAAC,CAAC,EAAC,IAAIrB,GAAG,CAACc,MAAM,CAAC;EAACL,CAAC,EAAE,IAAI;EAACC,CAAC,EAAE,GAAG;EAAEK,EAAE,EAAC,CAAC;EAAEC,KAAK,EAAC,CAAC;EAACC,IAAI,EAAC,CAAC;EAACC,IAAI,EAAC,CAAC;EAACC,aAAa,EAAC,CAAC;EAACC,QAAQ,EAAC,GAAG;EAACC,IAAI,EAAC;AAAQ,CAAC,CAAC,EACjN,IAAIrB,GAAG,CAACc,MAAM,CAAC;EAACL,CAAC,EAAE,IAAI;EAACC,CAAC,EAAE,GAAG;EAAEK,EAAE,EAAC,CAAC;EAAEC,KAAK,EAAC,CAAC;EAACC,IAAI,EAAC,CAAC;EAACC,IAAI,EAAC,CAAC;EAACC,aAAa,EAAC,CAAC;EAACC,QAAQ,EAAC,GAAG;EAACC,IAAI,EAAC;AAAQ,CAAC,CAAC,CAAC;;AAE7G;AACA,OAAO,IAAIC,QAAQ,GAAG,EAAE;AAExB,IAAIC,CAAC,GAAG,CAAC,CAAC;AACV,IAAIC,CAAC,GAAG,CAAC,CAAC;AACV,IAAMC,MAAM,GAAG,SAATA,MAAMA,CAAAC,IAAA,EAA6D;EAAA,IAAvDC,MAAM,GAAAD,IAAA,CAANC,MAAM;IAAEC,KAAK,GAAAF,IAAA,CAALE,KAAK;EAC7B;EACA,IAAMC,YAAmB,GAAG;IAC1BC,MAAM,EAAE;MACNC,GAAG,EAAE;QACHtB,CAAC,EAAE,GAAG;QACNC,CAAC,EAAE;MACL,CAAC;MACDK,EAAE,EAAE,CAAC;MACLC,KAAK,EAAE,EAAE;MACTC,IAAI,EAAE,CAAC;MACPC,IAAI,EAAE;IACR,CAAC;IAGDpB,SAAS,EAAE,IAAI;IACfkC,SAAS,EAAEzB,OAAO;IAClB0B,MAAM,EAAE;MACNxB,CAAC,EAAE,GAAG;MACNC,CAAC,EAAE,CAAC;MAEJwB,MAAM,EAAEN,KAAK;MACbO,OAAO,EAAER;IACX,CAAC;IACDS,OAAO,EAAEvB,UAAU;IACnBwB,KAAK,EAAEf;EACT,CAAC;EAED,IAAMgB,GAAG,GAAG7C,MAAM,EAAO;EACzB,IAAM8C,KAAK,GAAG9C,MAAM,CAAQoC,YAAY,CAAC;EAEzC,IAAM3B,OAAO,GAAG,SAAVA,OAAOA,CAAIE,GAA6B,EAAK;IAEjDmC,KAAK,CAACC,OAAO,GAAG7C,IAAI,CAAC4C,KAAK,CAACC,OAAO,CAAC;IACnCD,KAAK,CAACC,OAAO,GAAC5C,QAAQ,CAAC2C,KAAK,CAACC,OAAO,CAAC;IACrCD,KAAK,CAACC,OAAO,CAAC1C,SAAS,GAAG,CAACA,SAAS,CAACyC,KAAK,CAACC,OAAO,CAAC;IACnDzC,MAAM,CAACK,GAAG,EAACG,OAAO,CAAC,CAACgC,KAAK,CAACC,OAAO,CAAC;IAClC,IAAI,CAACD,KAAK,CAACC,OAAO,CAAC1C,SAAS,EAAEQ,qBAAqB,CAAC;MAAA,OAAMJ,OAAO,CAACE,GAAG,CAAC;IAAA,EAAC;EACzE,CAAC;EAGD,IAAMqC,MAAM,GAAG,SAATA,MAAMA,CAAIC,CAAe,EAAK;IAClCH,KAAK,CAACC,OAAO,GAAG3C,SAAS,CAAC0C,KAAK,CAACC,OAAO,CAAC,CAACE,CAAC,CAAC;EAC7C,CAAC;EAEDhD,SAAS,CAAC,YAAM;IACdO,UAAU,CAACC,OAAO,CAAC,CAACoC,GAAG,CAACE,OAAO,CAAC;EAClC,CAAC,EAAE,EAAE,CAAC;EACN,oBAAOhD,KAAA,CAAAmD,aAAA;IAAchB,MAAM,EAANA,MAAM;IAAEC,KAAK,EAALA,KAAK;IAAEU,GAAG,EAAHA,GAAG;IAAAM,MAAA,EAAAC,KAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,EAAM;AAC/C,CAAC;AAED,eAAezB,MAAM"},"metadata":{},"sourceType":"module"}